import shutil
import os
import logging
from src.config_log import logger

def mover_contenido(carpeta_origen, carpeta_destino):
    """
    Mueve todo el contenido de una carpeta de origen a una carpeta de destino.

    Parámetros:
    - carpeta_origen (str): La ruta de la carpeta de origen.
    - carpeta_destino (str): La ruta de la carpeta de destino.

    Excepciones:
    - FileNotFoundError: Se levanta si no se encuentran archivos en la carpeta de origen.
    - NotADirectoryError: Se levanta si la carpeta de destino no es un directorio válido.
    - shutil.Error: Se levanta si hay errores relacionados con la operación de movimiento.
    - Exception: Se levanta para manejar cualquier otra excepción no prevista.
    """
    try:
        # Si la carpeta destino no existe, la crea
        if not os.path.exists(carpeta_destino):
            os.makedirs(carpeta_destino)

        # Mover el contenido de la carpeta de origen a la carpeta destino
        for elemento in os.listdir(carpeta_origen):
            origen = os.path.join(carpeta_origen, elemento)
            destino = os.path.join(carpeta_destino, elemento)
            shutil.move(origen, destino)

        # Registrar mensaje de movimiento exitoso
        logger.info(f'Se movió el contenido de la carpeta {carpeta_origen} a la carpeta destino {carpeta_destino}')

    except FileNotFoundError:
        # Manejar el caso en que el archivo no se encuentre
        logger.error(f"No se encontraron archivos en la carpeta {carpeta_origen}.")

    except NotADirectoryError:
        # Manejar el caso en que la carpeta de destino no sea un directorio válido
        logger.error(f"La ruta de destino {carpeta_destino} no es un directorio válido.")

    except shutil.Error as e:
        # Manejar errores relacionados con la operación de movimiento
        logger.error(f"No se pudo mover el contenido de la carpeta {carpeta_origen} a la carpeta destino. Error: {e}")

    except Exception as e:
        # Manejar cualquier otra excepción no prevista
        logger.error(f"Ocurrió un error inesperado: {e}")

# Ejemplo de uso
carpeta_origen = '../apollo11/mover'
carpeta_destino = '../apollo11/destino'

mover_contenido(carpeta_origen, carpeta_destino)
